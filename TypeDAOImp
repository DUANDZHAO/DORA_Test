package DAODORA;

import java.util.LinkedList;
import java.util.List;
import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class TypeDAOImp extends DAOBase implements TypeDAO
{
	
//查，查一个类别有哪些文件
	public LinkedList<String>SearchTypes(String tid,Connection con)//tid类型号，测试函数如果输入一个类型名，则switch类型号
	{
		LinkedList<String> list = new LinkedList<String>();
		try {
		Connection conn=con;
	    Statement stmt;
		
			stmt = conn.createStatement();
		String sql="select * from Type,File,File_Type where (Type.typeid=File_Type.typeid) AND(File_Type.fileid=File.fileid) AND (Type.typeid=tid)";
	    ResultSet rs = stmt.executeQuery(sql);
		while(rs.next()) {
			String str = rs.getString(1) + " " + rs.getString(2) + " " +rs.getString(3);
			list.add(str);
		}
		conn.close();
		stmt.close();
		rs.close();
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return list;


		
	}
}
